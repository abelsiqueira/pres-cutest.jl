\AtBeginSection[]
{
  \begin{frame}
    \tableofcontents[currentsection]
  \end{frame}
}

\section{Introduction}

\subsection{Julia}

\myframectr{
  \begin{itemize}
    \item High level, High performance
    \item Great C/Fortran interface
    \item Easy syntax
  \end{itemize}
}

\subsection{CUTEst}

\myframectr{
  \begin{itemize}
    \item Repository of Nonlinear Optimization problems;
    \item Provides subroutines to obtain the problem's information;
    \item Decodes the problem, compiles your code with the problem's and runs
      your main code;
    \item Widely used.
  \end{itemize}
}

\subsection{CUTEst.jl}

\myframectr{
  \begin{itemize}
    \item Easy to install;
    \item Easy to use;
    \item Easy to optimize;
  \end{itemize}
}

\section{Why CUTEst.jl}

\subsection{CUTEst}

\begin{frame}[t,fragile]
  \ctr{CUTEst (Fortran)}
\begin{lstlisting}[language=Fortran]
CALL cutest_cdimen(st, ifile, n, m)
if (m.GT.0) THEN
  STOP
ENDIF
CALL cutest_usetup(st, ifile, 7, 11, n, x, bl, bu)
CALL cutest_ufn(st, n, x, f)
\end{lstlisting}
\end{frame}

\begin{frame}[t,fragile]
  \ctr{CUTEst.jl}
\begin{lstlisting}
Pkg.add("CUTEst") # Once
\end{lstlisting}
\begin{lstlisting}
using CUTEst

nlp = CUTEstModel("ROSENBR")
x = nlp.meta.x0

f = obj(nlp, x)
\end{lstlisting}
\end{frame}

\begin{frame}[t,fragile]
  \ctr{Example}
\lstinputlisting{src/newton.jl}
\begin{lstlisting}
f(x) = obj(nlp, x)
g(x) = grad(nlp, x)
H(x) = hess(nlp, x)
x = newton(f, g, H, nlp.meta.x0)
\end{lstlisting}
\end{frame}

\begin{frame}[t,fragile]
  \ctr{Example}
\lstinputlisting{src/newton.jl}
\begin{lstlisting}
f(x) = ufn(nlp, x) # Familiar names
g(x) = ugr(nlp, x) # are here too
H(x) = udh(nlp, x, nlp.meta.nvar)
x = newton(f, g, H, nlp.meta.x0)
\end{lstlisting}
\end{frame}

\subsection{Memory efficient}

\begin{frame}[t,fragile]
  \ctr{Example with inplace}
\lstinputlisting{src/newtoninplace.jl}
\end{frame}

\begin{frame}[t,fragile]
  \ctr{Example with inplace}
\begin{lstlisting}
f(x) = ufn(nlp, x)
g!(x, gx) = ugr!(nlp, x, gx)
H!(x, Hx) = udh!(nlp, x, nlp.meta.nvar, Hx)
x = newton(f, g!, H!, nlp.meta.x0)
\end{lstlisting}
\end{frame}

\subsection{The Fortran wrapper}

\begin{frame}[t,fragile]
  \ctr{Fortran wrapper}
\begin{lstlisting}
io_err = Cint[0]
n = Cint[nlp.meta.nvar]
f = [0.0]
ufn(io_err, n, x, f)
\end{lstlisting}
\end{frame}

\section{Workflow}

\myframe{
   ``... We should forget about the small efficiencies, say about 97\% of the
    time: {\bf premature optimization is the root of all evil}...'' \\
    Donald Knuth
}

\subsection{Test Driven Development}

\myframectr{
  \begin{itemize}
    \item {\it Create a failing test; Fix the test; Refactor code; Repeat.}
    \item Optimization doesn't have small building blocks;
    \item Simplest representative problem you should be able to solve;
    \item Classes of problems you should be able to solve;
    \item Selection of CUTEst problems you should be able to solve.
  \end{itemize}
}

\myframe{
  \ctr{Nonzero exit flag}
  \begin{itemize}
    \item Infinite loop;
    \item Wrong derivative;
    \item Budget limitations;
    \item Domain error.
  \end{itemize}
}

\myframe{
  \ctr{Scaling}
  \begin{itemize}
    \item Dense matrices;
    \item Inplace operations;
    \item Small efficiencies.
  \end{itemize}
}


\subsection{Thanks}
